import{_ as s,c as n,o as a,a as l}from"./app.64cc5612.js";const C=JSON.parse('{"title":"piniaæ’ä»¶å¼€å‘çš„ç¬”è®°","description":"","frontmatter":{"title":"piniaæ’ä»¶å¼€å‘çš„ç¬”è®°","tags":["piniaæ’ä»¶å¼€å‘"],"åˆ›å»ºæ—¶é—´":"æ˜ŸæœŸæ—¥, åäºŒæœˆ 4æ—¥ 2022, 10:23:52 æ™šä¸Š","ä¿®æ”¹æ—¶é—´":"æ˜ŸæœŸæ—¥, åäºŒæœˆ 4æ—¥ 2022, 11:37:59 æ™šä¸Š"},"headers":[{"level":2,"title":"ä¸»è¦åŠŸèƒ½","slug":"ä¸»è¦åŠŸèƒ½","link":"#ä¸»è¦åŠŸèƒ½","children":[]},{"level":2,"title":"å‚æ•°","slug":"å‚æ•°","link":"#å‚æ•°","children":[]},{"level":2,"title":"åŠ å…¥Ts","slug":"åŠ å…¥ts","link":"#åŠ å…¥ts","children":[]},{"level":2,"title":"å®‰è£…æ’ä»¶","slug":"å®‰è£…æ’ä»¶","link":"#å®‰è£…æ’ä»¶","children":[]},{"level":2,"title":"ä½¿ç”¨","slug":"ä½¿ç”¨","link":"#ä½¿ç”¨","children":[]}],"relativePath":"å·¥ä½œåŒº/æ¡†æ¶æŠ€æœ¯/Vue/æ’ä»¶å¼€å‘/piniaæ’ä»¶å¼€å‘.md"}'),p={name:"å·¥ä½œåŒº/æ¡†æ¶æŠ€æœ¯/Vue/æ’ä»¶å¼€å‘/piniaæ’ä»¶å¼€å‘.md"},o=l(`<p>#pinia #æ’ä»¶</p><h1 id="piniaæ’ä»¶å¼€å‘çš„ç¬”è®°" tabindex="-1">piniaæ’ä»¶å¼€å‘çš„ç¬”è®° <a class="header-anchor" href="#piniaæ’ä»¶å¼€å‘çš„ç¬”è®°" aria-hidden="true">#</a></h1><blockquote><p>ä¸ç”¨æœ‰å¤ªå¤§å¿ƒæ™ºè´Ÿæ‹…ï¼Œ å®‰è£…å’Œvueæ’ä»¶çš„å®‰è£…ä¸€æ ·çš„æ­¥éª¤ ç¼–å†™æ’ä»¶å‚è€ƒå®˜ç½‘å³å¯ <strong>ä¸»è¦æ˜¯æ‹“å±•æ¯ä¸ªstoreçš„åŠŸèƒ½</strong></p></blockquote><h2 id="ä¸»è¦åŠŸèƒ½" tabindex="-1">ä¸»è¦åŠŸèƒ½ <a class="header-anchor" href="#ä¸»è¦åŠŸèƒ½" aria-hidden="true">#</a></h2><ul><li>å…¬å…±å±æ€§</li><li>å…¬å…±æ–¹æ³•</li><li>é™åˆ¶ä»“åº“ä½¿ç”¨</li><li>æŒä¹…åŒ–ä»“åº“æ•°æ®</li></ul><p>æ›´å¤šåŠŸèƒ½<a href="https://pinia.vuejs.org/core-concepts/plugins.html" target="_blank" rel="noreferrer">å‚è€ƒå®˜ç½‘</a></p><ul><li>Add new properties to stores</li><li>Add new options when defining stores</li><li>Add new methods to stores</li><li>Wrap existing methods</li><li>Change or even cancel actions</li><li>Implement side effects likeÂ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage" target="_blank" rel="noreferrer">Local Storage</a></li><li>ApplyÂ <strong>only</strong>Â to specific stores</li></ul><h2 id="å‚æ•°" tabindex="-1">å‚æ•° <a class="header-anchor" href="#å‚æ•°" aria-hidden="true">#</a></h2><p>ä¸»è¦å›´ç»•context, å®ƒæœ‰å››ä¸ªå‚æ•°</p><ul><li>app vueå®ä¾‹</li><li>options optionså‚æ•°</li><li>pinia piniaå®ä¾‹</li><li>store (å¸¸ç”¨è¿™ä¸ª) å½“å‰çš„storeå®ä¾‹</li></ul><p>å¼€å‘ä¸€ä¸ªpiniaæ’ä»¶</p><p>åˆ›å»º <code>@/stores/plugins.ts</code> ç¼–å†™æ’ä»¶çš„ä¸»è¦é€»è¾‘</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">PiniaPluginContext</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pinia</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">testPlugins</span><span style="color:#89DDFF;">({</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">pinia</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PiniaPluginContext</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// é™åˆ¶ä»“åº“ ä¸º cart ä»“åº“</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$id</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cart</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// console.log(&quot;pinia plugins&quot;);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// console.log(options);</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// console.log(JSON.stringify(store));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// åŠ å…¥å…¬å…±æ–¹æ³•(å…¶å®æˆ‘è§‰å¾—æ²¡æœ‰å¿…è¦åŠ å¤§å¼€å‘æ—¶çš„å¿ƒæ™ºè´Ÿæ‹…)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">initialState</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$state</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">$reset</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">é€šè¿‡å…¬å…±æ–¹æ³•è°ƒç”¨</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$state</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">initialState</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// å½“ç„¶ä¹Ÿå¯ä»¥åŠ å…¥å…¬å…±state</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">author</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sam</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">// å˜åŒ–æ—¶ï¼Œè§¦å‘</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">$subscribe</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">mutation</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// react to store changes</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">mutation</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">[ğŸ </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">mutation</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">storeId</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">]: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">mutation</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="åŠ å…¥ts" tabindex="-1">åŠ å…¥Ts <a class="header-anchor" href="#åŠ å…¥ts" aria-hidden="true">#</a></h2><p>æ·»åŠ tsç±»å‹ï¼Œå¼€å‘æ—¶ä½“éªŒæç¤º</p><p>åˆ›å»º<code>pinia-plugin.d.ts</code></p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pinia</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">declare</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">module</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pinia</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">export</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">interface</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">PiniaCustomProperties</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Id</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">S</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">G</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">A</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    author</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="å®‰è£…æ’ä»¶" tabindex="-1">å®‰è£…æ’ä»¶ <a class="header-anchor" href="#å®‰è£…æ’ä»¶" aria-hidden="true">#</a></h2><p>åœ¨ <code>main.ts</code> ä¸­æ·»åŠ </p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createPinia</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">pinia</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">testPlugins</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@/stores/plugins.ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> pinia </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createPinia</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">pinia</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(testPlugins)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// å’Œå®‰è£…vueæ’ä»¶ä¸€æ ·çš„</span></span>
<span class="line"><span style="color:#82AAFF;">createApp</span><span style="color:#A6ACCD;">(app)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(pinia)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">mount</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="ä½¿ç”¨" tabindex="-1">ä½¿ç”¨ <a class="header-anchor" href="#ä½¿ç”¨" aria-hidden="true">#</a></h2><p>ä½¿ç”¨æŸä¸ªstoreæ—¶ï¼Œä½¿ç”¨ä¸ºå®ƒæ‹“å±•çš„æ’ä»¶åŠŸèƒ½</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">useCartStores</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../stores</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// ä½¿ç”¨å…¬å…±å±æ€§ ç”±äºåŠ äº†tsç±»å‹ æ‰€ä»¥å¼€å‘æ—¶ï¼Œä¸ä¼šæœ‰çº¢çº¿</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">author: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> stores</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">author)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// ä½¿ç”¨æ’ä»¶çš„å®šåˆ¶å…¬å…±æ–¹æ³•</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> handleResetCart </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">stores</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">$reset</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div>`,23),e=[o];function t(c,r,F,D,y,i){return a(),n("div",null,e)}const d=s(p,[["render",t]]);export{C as __pageData,d as default};
