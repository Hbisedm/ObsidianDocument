import{_ as s,c as n,o as a,d as o}from"./app.0b246d93.js";const C=JSON.parse('{"title":"github-actions的笔记","description":"","frontmatter":{"title":"github-actions的笔记","tags":["github-actions"],"创建时间":"星期二, 十月 18日 2022, 4:35:07 下午","修改时间":"星期二, 十月 18日 2022, 4:57:40 下午"},"headers":[{"level":2,"title":"是什么","slug":"是什么","link":"#是什么","children":[]},{"level":2,"title":"基本概念","slug":"基本概念","link":"#基本概念","children":[]},{"level":2,"title":"workflow 文件","slug":"workflow-文件","link":"#workflow-文件","children":[{"level":3,"title":"Name","slug":"name","link":"#name","children":[]},{"level":3,"title":"On","slug":"on","link":"#on","children":[]},{"level":3,"title":"Jobs","slug":"jobs","link":"#jobs","children":[]},{"level":3,"title":"jobs.<job_id>.needs","slug":"jobs-job-id-needs","link":"#jobs-job-id-needs","children":[]},{"level":3,"title":"jobs.<job_id>.runs-on","slug":"jobs-job-id-runs-on","link":"#jobs-job-id-runs-on","children":[]},{"level":3,"title":"jobs.<job_id>.steps","slug":"jobs-job-id-steps","link":"#jobs-job-id-steps","children":[]}]},{"level":2,"title":"参考链接","slug":"参考链接","link":"#参考链接","children":[]}],"relativePath":"工作区/开发工具/github-actions.md"}'),l={name:"工作区/开发工具/github-actions.md"},e=o(`<p>#github #action</p><h1 id="github-actions-的笔记" tabindex="-1">github-actions 的笔记 <a class="header-anchor" href="#github-actions-的笔记" aria-hidden="true">#</a></h1><h2 id="是什么" tabindex="-1">是什么 <a class="header-anchor" href="#是什么" aria-hidden="true">#</a></h2><p>大家知道，持续集成由很多操作组成，比如抓取代码、运行测试、登录远程服务器，发布到第三方服务等等。GitHub 把这些操作就称为 actions。</p><h2 id="基本概念" tabindex="-1">基本概念 <a class="header-anchor" href="#基本概念" aria-hidden="true">#</a></h2><p>（1）<strong>workflow</strong> （工作流程）：持续集成一次运行的过程，就是一个 workflow。</p><p>（2）<strong>job</strong> （任务）：一个 workflow 由一个或多个 jobs 构成，含义是一次持续集成的运行，可以完成多个任务。</p><p>（3）<strong>step</strong>（步骤）：每个 job 由多个 step 构成，一步步完成。</p><p>（4）<strong>action</strong> （动作）：每个 step 可以依次执行一个或多个命令（action）。</p><h2 id="workflow-文件" tabindex="-1">workflow 文件 <a class="header-anchor" href="#workflow-文件" aria-hidden="true">#</a></h2><h3 id="name" tabindex="-1">Name <a class="header-anchor" href="#name" aria-hidden="true">#</a></h3><p>workflow 的名称。</p><h3 id="on" tabindex="-1">On <a class="header-anchor" href="#on" aria-hidden="true">#</a></h3><p>触发指定 workflow 的条件</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#FF9CAC;">on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span></span>
<span class="line"></span></code></pre></div><p>push 事件会触发 workflow</p><p>on 字段可以是事件数组</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">on: [push, pull_request]</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>push 事件和 pull_request 事件都可以触发 workflow</p><p><code>on&lt;push&gt;&lt;tags|branches&gt;</code></p><p>可以先定分支或标签</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#FF9CAC;">on</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">push</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">branches</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">	  </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">master</span></span>
<span class="line"></span></code></pre></div><p>上面限定 master 分支发生 push 事件时，触发 workflow。</p><h3 id="jobs" tabindex="-1">Jobs <a class="header-anchor" href="#jobs" aria-hidden="true">#</a></h3><blockquote><p>workflow 文件的主体是 jobs 字段，表示要执行的一项或多项任务。</p></blockquote><p>jobs 字段里面，需要知道 job_id，具体名称自定义。job_id 的 name 字段是任务的说明。</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">my_first_job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">My first Job</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">my_second_job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">My second Job</span></span>
<span class="line"></span></code></pre></div><p>上面代码的 jobs 字段包含两项任务。<code>job_id</code>分别是<code>my_first_job</code>和<code>my_second_job</code></p><h3 id="jobs-job-id-needs" tabindex="-1"><code>jobs.&lt;job_id&gt;.needs</code> <a class="header-anchor" href="#jobs-job-id-needs" aria-hidden="true">#</a></h3><blockquote><p>needs 字段指定当前任务的依赖关系，也就是执行顺序</p></blockquote><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">job1</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">job2</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">needs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">job1</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">job3</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">needs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">job1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">job2</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><ul><li><code>job1</code>必须先于<code>job2</code>完成</li><li><code>job3</code>等待<code>job1</code>和<code>job2</code>的完成才能运行。</li></ul><h3 id="jobs-job-id-runs-on" tabindex="-1"><code>jobs.&lt;job_id&gt;.runs-on</code> <a class="header-anchor" href="#jobs-job-id-runs-on" aria-hidden="true">#</a></h3><p><code>runs-on</code>字段指定运行所需要的虚拟机环境。它是<strong>必填字段</strong>。目前可用的虚拟机如下。</p><ul><li><code>ubuntu-latest</code>，<code>ubuntu-18.04</code>或<code>ubuntu-16.04</code></li><li><code>windows-latest</code>，<code>windows-2019</code>或<code>windows-2016</code></li><li><code>macOS-latest</code>或<code>macOS-10.14</code></li></ul><h3 id="jobs-job-id-steps" tabindex="-1"><code>jobs.&lt;job_id&gt;.steps</code> <a class="header-anchor" href="#jobs-job-id-steps" aria-hidden="true">#</a></h3><blockquote><p><code>steps</code>字段指定每个 Job 的运行步骤，可以包含一个或多个步骤。每个步骤都可以指定以下三个字段。</p></blockquote><ul><li><code>jobs.&lt;job_id&gt;.steps.name</code>：步骤名称。</li><li><code>jobs.&lt;job_id&gt;.steps.run</code>：该步骤运行的命令或者 action。</li><li><code>jobs.&lt;job_id&gt;.steps.env</code>：该步骤所需的环境变量。</li></ul><p><strong>下面是一个完整的 workflow 文件的范例。</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki"><code><span class="line"><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Greeting from Mona</span></span>
<span class="line"><span style="color:#FF9CAC;">on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">push</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">jobs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">my-job</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">My Job</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">runs-on</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ubuntu-latest</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">steps</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Print a greeting</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">env</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">MY_VAR</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hi there! My name is</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">FIRST_NAME</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Mona</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">MIDDLE_NAME</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">The</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F07178;">LAST_NAME</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Octocat</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">run</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#C3E88D;">          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.</span></span>
<span class="line"></span></code></pre></div><h2 id="参考链接" tabindex="-1">参考链接 <a class="header-anchor" href="#参考链接" aria-hidden="true">#</a></h2><p><a href="https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" target="_blank" rel="noreferrer">阮一峰老师</a></p>`,42),p=[e];function t(c,r,i,d,y,D){return a(),n("div",null,p)}const h=s(l,[["render",t]]);export{C as __pageData,h as default};
